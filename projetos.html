<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="">
    <link rel="icon" href="img/">

    <title>Projetos | Aprendizagem Criativa</title>

    <!-- hosted MDL -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.green-amber.min.css">

    <!-- Custom styles -->
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700&subset=latin-ext" rel="stylesheet">
    <link href="/aprendizagem-criativa/css/style.css" rel="stylesheet">
    <!--<link href="/css/style.css" rel="stylesheet">-->

  </head>

  <body>

    <!-- Always shows a header, even in smaller screens. -->
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header mdl-layout--no-desktop-drawer-button">
      <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
          <!-- Title -->
          <a class="custom-title-link" href="/aprendizagem-criativa/index.html">
            <span class="mdl-layout-title font-override mdl-typography--font-bold font-color-white">Aprendizagem Criativa</span></a>
          <!-- Add spacer, to align navigation to the right -->
          <div class="mdl-layout-spacer"></div>
          <!-- Navigation. We hide it in small screens. -->
          <nav class="mdl-navigation mdl-layout--large-screen-only">
            <a class="mdl-navigation__link custom-nav" href="/aprendizagem-criativa/sobre.html">Sobre</a>
            <a class="mdl-navigation__link custom-nav" href="http://forum.aprendizagemcriativa.org">Fórum</a>
            <a class="mdl-navigation__link custom-nav" href="/aprendizagem-criativa/eventos.html">Eventos</a>
            <a class="mdl-navigation__link custom-nav isactive" href="">Projetos</a>
            <a class="mdl-navigation__link custom-nav" href="/aprendizagem-criativa/mapa.html">Mapa</a>
            <a class="mdl-navigation__link custom-nav" href="/aprendizagem-criativa/referencias.html">Referências</a>
          </nav>
        </div>
      </header>
      <div class="mdl-layout__drawer">
       <span class="mdl-layout-title font-override mdl-typography--font-bold"><a class="custom-drawer-link" href="/aprendizagem-criativa/index.html">Apredizagem Criativa</a></span>
        <nav class="mdl-navigation">
          <a class="mdl-navigation__link" href="/aprendizagem-criativa/sobre.html">Sobre</a>
          <a class="mdl-navigation__link" href="http://forum.aprendizagemcriativa.org">Fórum</a>
          <a class="mdl-navigation__link" href="/aprendizagem-criativa/eventos.html">Eventos</a>
          <a class="mdl-navigation__link" href="">Projetos</a>
          <a class="mdl-navigation__link" href="/aprendizagem-criativa/mapa.html">Mapa</a>
          <a class="mdl-navigation__link" href="/aprendizagem-criativa/referencias.html">Referências</a>
        </nav>
      </div>
      <main class="mdl-layout__content">
        <div class="banner">
          <h1 class="mdl-typography--text-center font-override margin-override">Galeria de Projetos</h1>
          <a href="http://forum.aprendizagemcriativa.org/c/projetos-e-iniciativas">
            <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--colored font-override font-color-white">
              Insira um Projeto
            </button> 
          </a>
        </div>
        <div class="mdl-grid custom-grid-projects" id="projects-grid">
          
        </div> 
      </main>
    </div>    

    <script src="https://code.jquery.com/jquery-3.1.0.slim.min.js" integrity="sha256-cRpWjoSOw5KcyIOaZNo4i6fZ9tKPhYYb6i5T9RSVJG8=" crossorigin="anonymous"></script>
    <script src="/aprendizagem-criativa/js/libs/mustache.min.js"></script>
    <script src="/aprendizagem-criativa/js/libs/miso.ds.min.deps.js"></script>
    <script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>
    <!-- page js to generate project cards from spreadsheet-->
    <script>
      var ds = new Miso.Dataset({
        importer : Miso.Dataset.Importers.GoogleSpreadsheet,
        parser : Miso.Dataset.Parsers.GoogleSpreadsheet,
        key : "1NbXz-KGJFVShvIQbpetoe3858mY0yCB1P2F7fOuudvw",
        worksheet : "1"
      });

      ds.fetch({ 
        success : function() {
          // if successfully fetch data from gsheet
          var approvedProjects = this.where({
            // copy over columns with project info
            columns: ["title", "organizer", "location", "description", "link", "image"],
            // and only where an admin has approved display
            rows: function(row) {
              return row.approved == "Display on website";
            }
          });
          // loop over each row of data and call loadProject
          approvedProjects.each(function(row){
            loadProject(row);
          });
        },
        error : function() {
          console.log("Huh, seems like we couldn't pull the data. Are you sure you're connected to the internet?");
        }
      });

      // generate HTML from template, where data is a row of spreadsheet data
      function loadProject(data) {
        var template = $('#project-template').html();
        Mustache.parse(template);
        var rendered = Mustache.render(template, data);
        $('#projects-grid').append(rendered);
        // set each project to have a background of the specified image
        $('#project-'+data._id).css('background-image','url('+data.image+')');
      };
    </script>

    <!-- project card template --> 
    <script id="project-template" type="x-tmpl-mustache">
       <div class="mdl-cell mdl-cell--6-col custom-cell-flex">
        <div class="custom-card-wide mdl-card mdl-shadow--2dp">
          <div class="mdl-card__title title-container-override" id="project-{{_id}}">
            <h2 class="mdl-card__title-text titles-override font-override">{{ title }}</h2>
            <h6 class="mdl-card__subtitle-text-custom font-override">organizado por {{ organizer }}</h6>
          </div>
          <div class="mdl-card__supporting-text custom-supporting-text">
            {{ description }}
          </div>
          <div class="mdl-card__actions mdl-card--border">
            <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect font-override" href="{{ link }}">
              Maiores Informações 
            </a>
          </div>
        </div> 
      </div> 
    </script>
  
  </body>
</html>
